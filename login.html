<!DOCTYPE html>
<html lang="es-CO">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <title>NeuroTek | Servicios tecnológicos</title>
    <script src="/js/persistence.js"></script>
    <script src="/js/components/Toast.js"></script>
</head>
<body>
    <div class="login--container">
        <div class="login--main--container">
            <img class="login--main--image" src="/images/logo_black.png" alt="Logo Neurotek">
            <h1 class="login--main--title">¡Hola!</h1>
            <p>Inicio de sesión para administradores</p>
            <form class="login--form" id="loginForm">
                <label class="login--form--label" for="user">Usuario</label>
                <input class="login--form--input" type="text" name="user" id="user" placeholder="Ingrese su nombre de usuario" required>
                <label class="login--form--label" for="password">Contraseña</label>
                <input class="login--form--input" type="password" name="password" id="password" placeholder="Ingrese su contraseña" required>
                <input class="button" type="submit" name="submit" value="Iniciar sesión">
            </form>
        </div>
    </div>
    <p class="login--footer">© <strong>2025 NeuroTek</strong> – Proyecto académico universitario. Uso exclusivo con fines educativos.</p>
    <script>
        const loginForm = document.getElementById('loginForm');

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();

            async function login() {
                const persistence = new Persistence();
                const user = e.target.elements['user'].value;
                const password = e.target.elements['password'].value;
                const formSubmitButton = e.target.elements['submit'];

                formSubmitButton.disabled = true;

                const loginResponse = await persistence.login(user, password);
                if (loginResponse === null) {
                    document.body.appendChild(createToast('negative', 'Usuario o Contraseña incorrectos'));
                    formSubmitButton.disabled = false;
                } else {
                    document.body.appendChild(createToast('positive', 'Ha iniciado sesión correctamente'));
                    setTimeout(() => {
                        window.location.href = '/dashboard.html';
                    }, 2000)
                }
            };
            void login();
        })
    </script>
</body>
</html>